-- 코드를 입력하세요
SELECT
    DISTINCT MONTH, CAR_ID, RECORDS
FROM (
        SELECT
            CAR_ID, TO_NUMBER(TO_CHAR(START_DATE, 'MM')) AS MONTH,
            COUNT(HISTORY_ID) OVER(PARTITION BY CAR_ID) AS CNT,
            COUNT(HISTORY_ID) OVER(PARTITION BY TO_CHAR(START_DATE, 'MM'), CAR_ID) AS RECORDS
        FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
        WHERE START_DATE BETWEEN TO_DATE('2022-08-01', 'YYYY-MM-DD')
            AND TO_DATE('2022-10-31', 'YYYY-MM-DD')
    )
WHERE CNT >= 5
ORDER BY MONTH, CAR_ID DESC

