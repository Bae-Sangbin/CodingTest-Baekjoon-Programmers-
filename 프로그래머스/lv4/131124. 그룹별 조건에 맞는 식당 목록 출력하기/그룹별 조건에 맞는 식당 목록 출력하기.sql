# REST_REVIEW
#기본키 : REVIEW_ID
# MEMBER_PROFILE
#기본키 : MEMBER_ID

# SELECT MEMBER_NAME, REVIEW_TEXT, DATE_FORMAT(REVIEW_DATE,'%Y-%m-%d') AS REVIEW_DATE
# FROM MEMBER_PROFILE A JOIN REST_REVIEW B ON A.MEMBER_ID = B.MEMBER_ID
# WHERE A.MEMBER_ID IN (SELECT MEMBER_ID, COUNT(*) AS 'COUNT'
#                     FROM MEMBER_PROFILE
#                     GROUP BY MEMBER_ID
#                     HAVING MAX(COUNT))
                    
# SELECT MEMBER_NAME, REVIEW_TEXT, DATE_FORMAT(REVIEW_DATE,'%Y-%m-%d') AS REVIEW_DATE
# FROM MEMBER_PROFILE A JOIN (SELECT MEMBER_ID, REVIEW_TEXT, REVIEW_DATE, COUNT(*)
#                             FROM REST_REVIEW
#                             GROUP BY MEMBER_ID) B ON A.MEMBER_ID = B.MEMBER_ID



# SELECT A.MEMBER_ID, REVIEW_TEXT, REVIEW_DATE,
# COUNT(*) OVER(PARTITION BY MEMBER_ID) AS CNT
# FROM MEMBER_PROFILE A JOIN REST_REVIEW B ON A.MEMBER_ID = B.MEMBER_ID

# SELECT MEMBER_NAME, REVIEW_TEXT, DATE_FORMAT(REVIEW_DATE,'%Y-%m-%d') AS REVIEW_DATE, R
# FROM 
# (SELECT A.MEMBER_ID, A.MEMBER_NAME, B.REVIEW_TEXT, B.REVIEW_DATE, COUNT(DISTINCT B.MEMBER_ID) AS R
# FROM MEMBER_PROFILE A INNER JOIN REST_REVIEW B ON A.MEMBER_ID = B.MEMBER_ID
# GROUP BY A.MEMBER_ID) AS C

# SELECT MEMBER_NAME, REVIEW_TEXT, DATE_FORMAT(REVIEW_DATE,'%Y-%m-%d') AS REVIEW_DATE
# FROM REST_REVIEW D JOIN (SELECT A.MEMBER_ID, A.MEMBER_NAME, B.REVIEW_ID, COUNT(*) AS CNT
# FROM MEMBER_PROFILE A JOIN REST_REVIEW B ON A.MEMBER_ID = B.MEMBER_ID
# GROUP BY A.MEMBER_ID) C ON D.REVIEW_ID = C.REVIEW_ID
# HAVING MAX(CNT)

SELECT MEMBER_NAME, REVIEW_TEXT, DATE_FORMAT(REVIEW_DATE,'%Y-%m-%d') AS REVIEW_DATE
FROM MEMBER_PROFILE M JOIN (SELECT MEMBER_ID, REVIEW_TEXT, REVIEW_DATE, 
                            COUNT(*) OVER(PARTITION BY MEMBER_ID) AS CNT
                            FROM REST_REVIEW) R ON M.MEMBER_ID = R.MEMBER_ID
WHERE CNT = (SELECT COUNT(*) CT
             FROM REST_REVIEW
             GROUP BY MEMBER_ID
             ORDER BY COUNT(*) DESC LIMIT 1)
ORDER BY REVIEW_DATE ASC, REVIEW_TEXT ASC;